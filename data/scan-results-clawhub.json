{
  "findings": [
    {
      "rule_id": "MCP_007",
      "rule_name": "Cross-tool data leakage",
      "severity": 3,
      "category": "mcp-attack",
      "description": "Detects patterns where file or credential reads are combined with data transmission",
      "file_path": "agentvoices.md",
      "line": 16,
      "matched_text": "get an `edit_token + send response",
      "context": [
        {
          "line": 13,
          "content": "",
          "is_match": false
        },
        {
          "line": 14,
          "content": "## Quick Start",
          "is_match": false
        },
        {
          "line": 15,
          "content": "",
          "is_match": false
        },
        {
          "line": 16,
          "content": "1. **Register** your bot to get an `edit_token`",
          "is_match": true
        },
        {
          "line": 17,
          "content": "2. **Browse** open topics",
          "is_match": false
        },
        {
          "line": 18,
          "content": "3. **Sign up** for a topic you want to debate",
          "is_match": false
        },
        {
          "line": 19,
          "content": "4. Wait for the arena to approve the lineup automatically (happens ~5 min before scheduled start)",
          "is_match": false
        }
      ],
      "score": 37.5,
      "analyzer": "pattern"
    },
    {
      "rule_id": "EXFIL_011",
      "rule_name": "External context or knowledge sync",
      "severity": 3,
      "category": "exfiltration",
      "description": "Detects CLI tools that upload project context, code, or knowledge to external services",
      "file_path": "multi-workplace.md",
      "line": 154,
      "matched_text": "Sync workplace context to external",
      "context": [
        {
          "line": 151,
          "content": "",
          "is_match": false
        },
        {
          "line": 152,
          "content": "## IDE Integration",
          "is_match": false
        },
        {
          "line": 153,
          "content": "",
          "is_match": false
        },
        {
          "line": 154,
          "content": "Sync workplace context to external coding tools:",
          "is_match": true
        },
        {
          "line": 155,
          "content": "",
          "is_match": false
        },
        {
          "line": 156,
          "content": "- **Cursor** → `.cursor/rules/workplace.mdc` (MDC with frontmatter)",
          "is_match": false
        },
        {
          "line": 157,
          "content": "- **Claude Code** → `CLAUDE.md` (markdown, marker-based updates)",
          "is_match": false
        }
      ],
      "score": 35,
      "analyzer": "pattern"
    },
    {
      "rule_id": "EXFIL_007",
      "rule_name": "Environment variable exfiltration",
      "severity": 3,
      "category": "exfiltration",
      "description": "Detects attempts to read and transmit environment variables",
      "file_path": "stack-scaffold.md",
      "line": 138,
      "matched_text": "process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SEND",
      "context": [
        {
          "line": 135,
          "content": "  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,",
          "is_match": false
        },
        {
          "line": 136,
          "content": "  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,",
          "is_match": false
        },
        {
          "line": 137,
          "content": "  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,",
          "is_match": false
        },
        {
          "line": 138,
          "content": "  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,",
          "is_match": true
        },
        {
          "line": 139,
          "content": "  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,",
          "is_match": false
        },
        {
          "line": 140,
          "content": "};",
          "is_match": false
        },
        {
          "line": 141,
          "content": "",
          "is_match": false
        }
      ],
      "score": 35,
      "analyzer": "pattern"
    },
    {
      "rule_id": "PROMPT_INJECTION_017",
      "rule_name": "Autonomous agent spawning",
      "severity": 3,
      "category": "prompt-injection",
      "description": "Detects autonomous sub-agent or cron-based execution without human oversight",
      "file_path": "tester.md",
      "line": 3,
      "matched_text": "spawn sub-agent",
      "context": [
        {
          "line": 1,
          "content": "# GitHub Issue Manager",
          "is_match": false
        },
        {
          "line": 2,
          "content": "",
          "is_match": false
        },
        {
          "line": 3,
          "content": "Fetch GitHub issues, spawn sub-agents to implement fixes, open PRs, and monitor review comments.",
          "is_match": true
        },
        {
          "line": 4,
          "content": "",
          "is_match": false
        },
        {
          "line": 5,
          "content": "## Overview",
          "is_match": false
        },
        {
          "line": 6,
          "content": "",
          "is_match": false
        }
      ],
      "score": 37.5,
      "analyzer": "pattern"
    },
    {
      "rule_id": "PROMPT_INJECTION_017",
      "rule_name": "Autonomous agent spawning",
      "severity": 3,
      "category": "prompt-injection",
      "description": "Detects autonomous sub-agent or cron-based execution without human oversight",
      "file_path": "tester.md",
      "line": 9,
      "matched_text": "Spawn sub-agent",
      "context": [
        {
          "line": 6,
          "content": "",
          "is_match": false
        },
        {
          "line": 7,
          "content": "This skill enables autonomous issue management on GitHub repositories. It can:",
          "is_match": false
        },
        {
          "line": 8,
          "content": "- List and filter issues by labels, milestones, assignees",
          "is_match": false
        },
        {
          "line": 9,
          "content": "- Spawn sub-agents to work on fixes",
          "is_match": true
        },
        {
          "line": 10,
          "content": "- Create PRs with automated descriptions",
          "is_match": false
        },
        {
          "line": 11,
          "content": "- Track PR review status and respond to comments",
          "is_match": false
        },
        {
          "line": 12,
          "content": "",
          "is_match": false
        }
      ],
      "score": 37.5,
      "analyzer": "pattern"
    },
    {
      "rule_id": "MCP_007",
      "rule_name": "Cross-tool data leakage",
      "severity": 3,
      "category": "mcp-attack",
      "description": "Detects patterns where file or credential reads are combined with data transmission",
      "file_path": "the-uninscribed.md",
      "line": 43,
      "matched_text": "get their confirmation. The config + post duplicate content",
      "context": [
        {
          "line": 40,
          "content": "",
          "is_match": false
        },
        {
          "line": 41,
          "content": "### Step 1: Configure Everything",
          "is_match": false
        },
        {
          "line": 42,
          "content": "",
          "is_match": false
        },
        {
          "line": 43,
          "content": "**⚠️ Before applying:** Explain to your user what you're about to do and get their confirmation. The config patch will:",
          "is_match": true
        },
        {
          "line": 44,
          "content": "- Add a new `uninscribed-player` agent (using Sonnet, a cheaper model)",
          "is_match": false
        },
        {
          "line": 45,
          "content": "- Enable agent-to-agent messaging so you can coordinate with the player",
          "is_match": false
        },
        {
          "line": 46,
          "content": "- Set up heartbeats for both agents (preserving the main agent's existing interval)",
          "is_match": false
        }
      ],
      "score": 37.5,
      "analyzer": "pattern"
    },
    {
      "rule_id": "EXFIL_002",
      "rule_name": "Sensitive file read pattern",
      "severity": 3,
      "category": "exfiltration",
      "description": "Detects reads of sensitive system or credential files",
      "file_path": "the-uninscribed.md",
      "line": 136,
      "matched_text": "Read ~/.config",
      "context": [
        {
          "line": 133,
          "content": "```markdown",
          "is_match": false
        },
        {
          "line": 134,
          "content": "# The Uninscribed — Play Session",
          "is_match": false
        },
        {
          "line": 135,
          "content": "",
          "is_match": false
        },
        {
          "line": 136,
          "content": "1. Read ~/.config/the-uninscribed/session-log.md for context on where you left off",
          "is_match": true
        },
        {
          "line": 137,
          "content": "2. The CLI is at: skills/the-uninscribed/uninscribed.py (resolve relative to workspace)",
          "is_match": false
        },
        {
          "line": 138,
          "content": "3. Run `python3 \u003ccli\u003e observe` to see the world",
          "is_match": false
        },
        {
          "line": 139,
          "content": "4. Take actions in a loop:",
          "is_match": false
        }
      ],
      "score": 35,
      "analyzer": "pattern"
    },
    {
      "rule_id": "EXTDL_002",
      "rule_name": "Remote SDK or script fetch as agent input",
      "severity": 2,
      "category": "external-download",
      "description": "Detects fetching remote documentation or code to load as agent context",
      "file_path": "agentvoices.md",
      "line": 42,
      "matched_text": "Fetch `GET  + https://agentvoices.ai/SKILL.md",
      "context": [
        {
          "line": 39,
          "content": "",
          "is_match": false
        },
        {
          "line": 40,
          "content": "```markdown",
          "is_match": false
        },
        {
          "line": 41,
          "content": "## AgentVoices",
          "is_match": false
        },
        {
          "line": 42,
          "content": "- [ ] Fetch `GET https://agentvoices.ai/api/v1/topics` — if any new open topic matches your persona and has `slots_remaining \u003e 0`, notify your human operator with the topic title, description, and why it fits. Only sign up after they approve. Only `open` topics accept signups.",
          "is_match": true
        },
        {
          "line": 43,
          "content": "- [ ] Fetch `GET https://agentvoices.ai/api/v1/conversations` (with Bearer token) for new conversations. When a new `pending` conversation appears, schedule a cron job to connect 5 minutes before its `scheduled_at` time.",
          "is_match": false
        },
        {
          "line": 44,
          "content": "- [ ] If any conversation has status `live` and you are not connected, connect immediately — you may be missing turns. Turns time out after 60 seconds.",
          "is_match": false
        },
        {
          "line": 45,
          "content": "```",
          "is_match": false
        }
      ],
      "score": 15,
      "analyzer": "pattern"
    },
    {
      "rule_id": "NLP_AUTHORITY_CLAIM",
      "rule_name": "Section claims authority and urgency with dangerous instructions",
      "severity": 2,
      "category": "prompt-injection",
      "description": "Section claims authority and urgency with dangerous instructions",
      "file_path": "indexy.md",
      "line": 631,
      "matched_text": "Common HTTP Status Codes:\n| Code | Meaning | Common Causes |\n|------|---------|---------------|\n| 400 | Bad Request | Weights don't sum to 100, missing required fields, invalid characters, exceeding 5...",
      "context": [
        {
          "line": 628,
          "content": "",
          "is_match": false
        },
        {
          "line": 629,
          "content": "The `details` field (when present) maps field names to arrays of validation error messages.",
          "is_match": false
        },
        {
          "line": 630,
          "content": "",
          "is_match": false
        },
        {
          "line": 631,
          "content": "**Common HTTP Status Codes:**",
          "is_match": true
        },
        {
          "line": 632,
          "content": "| Code | Meaning | Common Causes |",
          "is_match": false
        },
        {
          "line": 633,
          "content": "|------|---------|---------------|",
          "is_match": false
        },
        {
          "line": 634,
          "content": "| `400` | Bad Request | Weights don't sum to 100, missing required fields, invalid characters, exceeding 50 token limit |",
          "is_match": false
        }
      ],
      "score": 22.5,
      "analyzer": "nlp-injection"
    }
  ],
  "files_scanned": 24,
  "rules_loaded": 85,
  "duration_ms": 207
}
